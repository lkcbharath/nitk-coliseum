<%= form_for(response) do |f| %>
  <% if response.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(response.errors.count, "error") %> prohibited this response from being saved:</h2>

      <ul>
      <% response.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <% if question = current_user.questions.first %>

    <div class="field">
      <%= f.label question.description %>
    </div>

    <div class="field" style="display: none;">
      <%= f.radio_button :given_response, 0, :checked => "checked" %>
    </div>

    <div class="field">
      <%= f.label question.option_1 %>
      <%= f.radio_button :given_response, 1 %>
    </div>

    <div class="field">
      <%= f.label question.option_2 %>
      <%= f.radio_button :given_response, 2 %>
    </div>

    <div class="field">
      <%= f.label question.option_3 %>
      <%= f.radio_button :given_response, 3 %>
    </div>

    <div class="field">
      <%= f.label question.option_4 %>
      <%= f.radio_button :given_response, 4 %>
    </div>

    <div class = "<%= controller_name %> <%= action_name %>">
      <div class="actions">
        <%= f.submit :id => "response_submit" %>
      </div>
    </div>

    <p id="timer">10</p>

  <% end %>

  <script>
    document.onload = setTimeout(function () { response_submit.click(); }, 10000);
    //document.onload = setTimeout(function () { alert(timer.html); }, 10000);
  </script>

  <script>
    document.getElementById('timer').innerHTML = "00" + ":" + "11";
    startTimer();

    function startTimer() {
      var presentTime = document.getElementById('timer').innerHTML;
      var timeArray = presentTime.split(/[:]+/);
      var m = timeArray[0];
      var s = checkSecond((timeArray[1] - 1));
      if(s==59){m=m-1}
      //if(m<0){alert('timer completed')}
      
      document.getElementById('timer').innerHTML = m + ":" + s;
      setTimeout(startTimer, 1000);
    }

    function checkSecond(sec) {
      if (sec < 10 && sec >= 0) {sec = "0" + sec}; // add zero in front of numbers < 10
      if (sec < 0) {sec = "59"};
      return sec;
    }
  </script>

<% end %>
